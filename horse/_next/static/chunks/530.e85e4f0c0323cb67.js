"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[530],{1530:function(e,r,s){s.r(r),s.d(r,{default:function(){return l}});var n=s(5893);s(7294);var o=s(1163),t=s(2671),a=s(9410);let c=e=>{let{track:r,playerHorse:s,onRaceFinish:o,onStartRace:c,onReturnToMenu:l}=e,{dispatch:u}=(0,t.G)();return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-4",children:[(0,n.jsx)(a.P,{track:r,playerHorse:s,onRaceFinish:e=>{let n=e.find(e=>e.horseId===s.id);if(n){let e=i(n.position,r.prizePool);u({type:"ADD_COINS",payload:e}),u({type:"UPDATE_HORSE",payload:{...s,races:(s.races||0)+1,wonRaces:1===n.position?(s.wonRaces||0)+1:s.wonRaces||0,goldWon:(s.goldWon||0)+e,raceHistory:[...s.raceHistory||[],n]}})}o(e)}}),(0,n.jsxs)("div",{className:"mt-4 space-x-4",children:[(0,n.jsx)("button",{onClick:c,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg",children:"بدء السباق"}),(0,n.jsx)("button",{onClick:l,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg",children:"العودة للقائمة"})]})]})},i=(e,r)=>Math.floor(r*(({1:.5,2:.3,3:.2})[e]||0));function l(){let e=(0,o.useRouter)(),{state:r,dispatch:s}=(0,t.G)(),{id:a}=e.query,i=r.tracks.find(e=>e.id===a),l=r.selectedHorse;return i&&l?(0,n.jsx)(c,{track:i,playerHorse:l,onStartRace:()=>{},onReturnToMenu:()=>{e.push("/races")},onRaceFinish:n=>{let o=n.find(e=>e.horseId===l.id);o&&(s({type:"UPDATE_USER",payload:{...r.user,coins:r.user.coins+o.prize,raceHistory:[...r.user.raceHistory,o]}}),setTimeout(()=>e.push("/races"),3e3))}}):(e.push("/races"),null)}}}]);